/*! httpinvoke 2013-10-02 */
!function(a,b){"function"==typeof define&&define.amd?define(b):"object"==typeof exports?module.exports=b():a.httpinvoke=b()}(this,function(){var a=function(a){var b=function(b){return"object"==typeof b&&null!==b&&("undefined"!=typeof a.ArrayBufferView&&b instanceof a.ArrayBufferView||"undefined"!=typeof a.Int8Array&&b instanceof a.Int8Array||"undefined"!=typeof a.Uint8Array&&b instanceof a.Uint8Array||"undefined"!=typeof a.Uint8ClampedArray&&b instanceof a.Uint8ClampedArray||"undefined"!=typeof a.Int16Array&&b instanceof a.Int16Array||"undefined"!=typeof a.Uint16Array&&b instanceof a.Uint16Array||"undefined"!=typeof a.Int32Array&&b instanceof a.Int32Array||"undefined"!=typeof a.Uint32Array&&b instanceof a.Uint32Array||"undefined"!=typeof a.Float32Array&&b instanceof a.Float32Array||"undefined"!=typeof a.Float64Array&&b instanceof a.Float64Array)},c=function(c){return"object"==typeof c&&null!==c&&("undefined"!=typeof a.Buffer&&c instanceof a.Buffer||"undefined"!=typeof a.Blob&&c instanceof a.Blob||"undefined"!=typeof a.File&&c instanceof a.File||"undefined"!=typeof a.ArrayBuffer&&c instanceof a.ArrayBuffer||b(c)||"[object Array]"===Object.prototype.toString.call(c))},d="an instance of Buffer, nor Blob, nor File, nor ArrayBuffer, nor ArrayBufferView, nor Int8Array, nor Uint8Array, nor Uint8ClampedArray, nor Int16Array, nor Uint16Array, nor Int32Array, nor Uint32Array, nor Float32Array, nor Float64Array, nor Array",e=["GET","HEAD","POST","PUT","DELETE"],f="undefined"==typeof[].indexOf?function(a,b){for(var c=0;c<a.length;c+=1)if(a[c]===b)return c;return-1}:function(a,b){return a.indexOf(b)},g=["accept-charset","accept-encoding","access-control-request-headers","access-control-request-method","connection","content-length","content-transfer-encoding","cookie","cookie2","date","dnt","expect","host","keep-alive","origin","referer","te","trailer","transfer-encoding","upgrade","user-agent","via"],h=function(a){for(var b in a)if(a.hasOwnProperty(b)){var c=b.toLowerCase();if(f(g,c)>=0)throw new Error("Input header "+b+" is forbidden to be set programmatically");if("proxy-"===c.substr(0,"proxy-".length))throw new Error("Input header "+b+" (to be precise, all Proxy-*) is forbidden to be set programmatically");if("sec-"===c.substr(0,"sec-".length))throw new Error("Input header "+b+" (to be precise, all Sec-*) is forbidden to be set programmatically")}},i=function(){},j=function(a){return a},k=a.setImmediate||a.setTimeout,l=function(a,b){return k(function(){null!==a&&a(b)}),i},m=function(a,b,g){var k={uri:a};"undefined"==typeof b?(k.method="GET",g={}):"undefined"==typeof g?"string"==typeof b?(k.method=b,g={}):(k.method="GET",g=b):k.method=b,g="function"==typeof g?{finished:g}:g;var m=function(a){return"undefined"==typeof g[a]?i:function(){try{g[a].apply(null,arguments)}catch(b){}}};k.uploadProgressCb=m("uploading");var n=m("downloading");k.statusCb=m("gotStatus"),k.cb=m("finished"),k.timeout=g.timeout||0;var o,p=g.converters||{};if(k.inputLength=0,k.inputHeaders=g.headers||{},k.outputType=g.outputType||"text",k.outputHeaders={},k.exposedHeaders=g.corsExposedHeaders||[],k.exposedHeaders.push.apply(k.exposedHeaders,["Cache-Control","Content-Language","Content-Type","Content-Length","Expires","Last-Modified","Pragma","Content-Range"]),k.corsOriginHeader=g.corsOriginHeader||"X-Httpinvoke-Origin",k.corsCredentials=!!g.corsCredentials,f(e,k.method)<0)return l(k.cb,new Error("Unsupported method "+k.method));if("text"===k.outputType||"bytearray"===k.outputType)k.outputConverter=j;else if("undefined"!=typeof p["text "+k.outputType])k.outputConverter=p["text "+k.outputType],k.outputType="text";else{if("undefined"==typeof p["bytearray "+k.outputType])return l(k.cb,new Error("Unsupported outputType "+k.outputType));k.outputConverter=p["bytearray "+k.outputType],k.outputType="bytearray"}if("undefined"==typeof g.input){if("undefined"!=typeof g.inputType)return l(k.cb,new Error('"input" is undefined, but inputType is defined'));if("undefined"!=typeof k.inputHeaders["Content-Type"])return l(k.cb,new Error('"input" is undefined, but Content-Type request header is defined'))}else{if(k.input=g.input,"undefined"==typeof g.inputType||"auto"===g.inputType)if("string"==typeof k.input)k.inputType="text";else{if(!c(k.input))return l(k.cb,new Error("inputType is undefined or auto and input is neither string, nor "+d));k.inputType="bytearray"}else if(k.inputType=g.inputType,"text"===k.inputType){if("string"!=typeof k.input)return l(k.cb,new Error("inputType is text, but input is not a string"))}else if("bytearray"===k.inputType&&!c(k.input))return l(k.cb,new Error("inputType is bytearray, but input is neither "+d));if("undefined"!=typeof p[k.inputType+" text"])o=p[k.inputType+" text"],k.inputType="text";else if("undefined"!=typeof p[k.inputType+" bytearray"])o=p[k.inputType+" bytearray"],k.inputType="bytearray";else{if("text"!==k.inputType&&"bytearray"!==k.inputType)return l(k.cb,new Error("There is no converter for specified inputType"));o=j}"text"===k.inputType?"undefined"==typeof k.inputHeaders["Content-Type"]&&(k.inputHeaders["Content-Type"]="text/plain; charset=UTF-8"):"bytearray"===k.inputType&&("undefined"==typeof k.inputHeaders["Content-Type"]&&(k.inputHeaders["Content-Type"]="application/octet-stream"),"undefined"!=typeof ArrayBuffer&&k.input instanceof ArrayBuffer?k.input=new Uint8Array(k.input):("undefined"!=typeof Int16Array&&k.input instanceof Int16Array||"undefined"!=typeof Uint16Array&&k.input instanceof Uint16Array||"undefined"!=typeof Int32Array&&k.input instanceof Int32Array||"undefined"!=typeof Uint32Array&&k.input instanceof Uint32Array||"undefined"!=typeof Float32Array&&k.input instanceof Float32Array||"undefined"!=typeof Float64Array&&k.input instanceof Float64Array)&&(k.input=new Uint8Array(k.input.buffer,k.input.byteOffset,k.input.byteLength)));try{k.input=o(k.input)}catch(q){return l(k.cb,q)}}try{h(k.inputHeaders)}catch(q){return l(k.cb,q)}var r;return k.initDownload=function(a){"undefined"==typeof k.outputLength&&(k.outputLength=a,n(r,k.outputLength))},k.updateDownload=function(a){a!==r&&(r=a,n(r,k.outputLength))},k.noData=function(){k.initDownload(0),null!==k.cb&&(k.cb(null,k._undefined,k.status,k.outputHeaders),k.cb=null)},k};return{isArrayBufferView:b,failWithoutRequest:l,initialize:m,noop:i}};a=a(window);var b,c,d=function(a){return"string"==typeof a&&""!==a},e={Continue:100,"Switching Protocols":101,OK:200,Created:201,Accepted:202,"Non-Authoritative Information":203,"No Content":204,"Reset Content":205,"Partial Content":206,"Multiple Choices":300,"Moved Permanently":301,Found:302,"See Other":303,"Not Modified":304,"Use Proxy":305,"Temporary Redirect":307,"Bad Request":400,Unauthorized:401,"Payment Required":402,Forbidden:403,"Not Found":404,"Method Not Allowed":405,"Not Acceptable":406,"Proxy Authentication Required":407,"Request Timeout":408,Conflict:409,Gone:410,"Length Required":411,"Precondition Failed":412,"Request Entity Too Large":413,"Request-URI Too Long":414,"Unsupported Media Type":415,"Requested Range Not Satisfiable":416,"Expectation Failed":417,"Internal Server Error":500,"Not Implemented":501,"Bad Gateway":502,"Service Unavailable":503,"Gateway Time-out":504,"HTTP Version Not Supported":505},f=function(a,b,c){return 0===b&&c===a.byteLength?a:"undefined"==typeof a.slice?new Uint8Array(Array.prototype.slice.call(new Uint8Array(a),b,c)).buffer:a.slice(b,c)};!function(){try{var a="";a+="Function httpinvoke_BinaryExtract(Binary, Array)\r\n",a+="    Dim len, i\r\n",a+="    len = LenB(Binary)\r\n",a+="    For i = 1 to len\r\n",a+="        Array.push(AscB(MidB(Binary, i, 1)))\r\n",a+="    Next\r\n",a+="End Function\r\n",a+="\r\n",a+="Function httpinvoke_BinaryLength(Binary)\r\n",a+="    httpinvoke_BinaryLength = LenB(Binary)\r\n",a+="End Function\r\n",a+="\r\n",window.execScript(a,"vbscript");for(var d={},e=0;256>e;e+=1)for(var f=0;256>f;f+=1)d[String.fromCharCode(e+256*f)]=String.fromCharCode(e)+String.fromCharCode(f);b=function(a){var b=[];return window.httpinvoke_BinaryExtract(a,b),b},c=function(a){return window.httpinvoke_BinaryLength(a)}}catch(g){}}();var g,h={text:function(a){return"undefined"!=typeof a.response?a.response:a.responseText},bytearray:function(a){if("undefined"!=typeof a.response)return new Uint8Array(null===a.response?[]:a.response);if("undefined"!=typeof a.responseBody)return b(a.responseBody);for(var c=a.responseText,d=c.length,e=new Array(d),f=0;d>f;f+=1)e[f]=255&c.charCodeAt(f);return"undefined"!=typeof Uint8Array?new Uint8Array(e):e}},i={text:function(a){return k(h.text(a))},bytearray:function(a){return"undefined"!=typeof a.response?null===a.response?0:a.response.byteLength:"undefined"!=typeof a.responseBody?c(a.responseBody):a.responseText.length}},j="undefined"==typeof"".trim?function(a){return a.replace(/^\s+|\s+$/g,"")}:function(a){return a.trim()},k=function(a){for(var b=0,c=0;c<a.length;c+=1){var d=a.charCodeAt(c);b+=128>d?1:2048>d?2:3}return b},l=function(a){for(var b="",c=0;c<a.length;c+=1)b+=String.fromCharCode(a[c]);return b},m=function(a){var b=a.indexOf(":");return{name:a.slice(0,b).toLowerCase(),value:j(a.slice(b+1))}},n=function(a,b,c){for(var d,b=a.getAllResponseHeaders().split(/\r?\n/),e=b.length-1,f=!1;e>=0;)d=j(b[e]),d.length>0&&(d=m(d),c[d.name]=d.value,f=!0),e-=1;return f},o=/^([\w.+-]+:)(?:\/\/([^\/?#:]*)(?::(\d+)|)|)/,p=function(a,b){return b=o.exec(b.toLowerCase()),a=o.exec(a.toLowerCase())||[],!(!b||b[1]===a[1]&&b[2]===a[2]&&(b[3]||("http:"===b[1]?"80":"443"))===(a[3]||("http:"===a[1]?"80":"443")))},q=function(){var b=a.initialize.apply(null,arguments);if("function"==typeof b)return b;var c,j=!1,m=function(a){null!==b.uploadProgressCb&&(j||(j=!0,b.uploadProgressCb(0,b.inputLength)),b.uploadProgressCb(a,b.inputLength),a===b.inputLength&&(b.uploadProgressCb=null))};try{c=window.location.href}catch(o){c=window.document.createElement("a"),c.href="",c=c.href}var r=p(c,b.uri);if("bytearray"===b.inputType&&q.requestTextOnly)return a.failWithoutRequest(b.cb,new Error("bytearray inputType is not supported on this platform, please always test using requestTextOnly feature flag"));if(r&&!q.cors)return a.failWithoutRequest(b.cb,new Error("Cross-origin requests are not supported"));if(r&&"DELETE"===b.method&&!q.corsDELETE)return a.failWithoutRequest(b.cb,new Error("DELETE method in cross-origin requests is not supported in this browser"));if(r&&"PUT"===b.method&&!q.corsPUT)return a.failWithoutRequest(b.cb,new Error("PUT method in cross-origin requests is not supported in this browser"));if(r&&"HEAD"===b.method&&!q.corsHEAD)return a.failWithoutRequest(b.cb,new Error("HEAD method in cross-origin requests is not supported in this browser"));var s=g(r);s.open(b.method,b.uri,!0),b.timeout>0&&("undefined"==typeof s.timeout?setTimeout(function(){b.cb(new Error("download timeout")),b.cb=null},b.timeout):s.timeout=b.timeout),b.corsCredentials&&q.corsCredentials&&"boolean"==typeof s.withCredentials&&(s.withCredentials=!0),r&&(b.inputHeaders[b.corsOriginHeader]=window.location.protocol+"//"+window.location.host);var t=function(a){null!==b.cb&&a&&a.lengthComputable&&m(a.loaded)};"undefined"!=typeof s.upload?(s.upload.ontimeout=function(){null!==b.cb&&(b.cb(new Error("upload timeout")),b.cb=null)},s.upload.onerror=function(){null!==b.cb&&(b.cb(new Error("upload error")),b.cb=null)},s.upload.onprogress=t):"undefined"!=typeof s.onuploadprogress&&(s.onuploadprogress=t),"undefined"!=typeof s.ontimeout&&(s.ontimeout=function(){null!==b.cb&&(b.cb(new Error("download timeout")),b.cb=null)}),"undefined"!=typeof s.onerror&&(s.onerror=function(a){inspect("onerror",a),w()}),"undefined"!=typeof s.onloadstart&&(s.onloadstart=function(){v(!1)}),"undefined"!=typeof s.onloadend&&(s.onloadend=function(){v(!1)}),"undefined"!=typeof s.onprogress&&(s.onprogress=function(a){if(null!==b.cb&&(v(!1),null===b.statusCb&&"undefined"!=typeof a)){var c=a.total||a.totalSize||0,d=a.loaded||a.position||0;if(a.lengthComputable&&b.initDownload(c),null===b.cb)return;if(d>c)return;b.updateDownload(d)}});var u={success:!1,status:!1,entity:!1,headers:!1},v=function(a){if(null!==b.cb){try{"number"==typeof s.status&&s.status>0&&(u.status=!0)}catch(c){}try{d(s.statusText)&&(u.status=!0)}catch(c){}try{d(s.responseText)&&(u.entity=!0)}catch(c){}try{(d(s.response)||"object"==typeof s.response&&null!==s.response)&&(u.entity=!0)}catch(c){}if(null!==b.statusCb){if(u.status||u.entity||u.success||a){"string"==typeof s.contentType&&("text/html"!==s.contentType||""!==s.responseText)&&(b.outputHeaders["content-type"]=s.contentType,u.headers=!0);for(var f=0;f<b.exposedHeaders.length;f+=1)try{var g=s.getResponseHeader(b.exposedHeaders[f]);null!==g&&""!==g&&(b.outputHeaders[b.exposedHeaders[f].toLowerCase()]=g,u.headers=!0)}catch(h){}try{n(s,b.outputHeaders)&&(u.headers=!0)}catch(h){}if("undefined"==typeof b.status&&(!r||q.corsStatus)){try{"number"==typeof s.status&&s.status>0&&(b.status=s.status)}catch(c){}if("undefined"==typeof b.status)try{"undefined"!=typeof e[s.statusText]&&(b.status=e[s.statusText])}catch(c){}1223===b.status&&(b.status=204)}}if((a||u.status&&u.headers)&&(m(b.inputLength),null!==b.cb&&(b.statusCb(b.status,b.outputHeaders),b.statusCb=null,null!==b.cb))){if("HEAD"===b.method)return b.noData();b.updateDownload(0),null!==b.cb&&"undefined"!=typeof b.outputHeaders["content-length"]&&(b.initDownload(Number(b.outputHeaders["content-length"])),null===b.cb)}}}},w=function(){if(null!==b.cb&&(v(!0),null!==b.cb)){if(!u.success&&"undefined"==typeof b.status)return b.cb(new Error("download error")),b.cb=null,void 0;var a;try{a=i[b.outputType](s)}catch(c){return b.noData()}if("undefined"==typeof b.outputLength){if(b.initDownload(a),null===b.cb)return}else if(a!==b.outputLength)return b.cb(new Error("download error")),b.cb=null,void 0;if(b.updateDownload(b.outputLength),null!==b.cb){try{b.cb(null,u.entity||0!==b.outputLength||"undefined"!=typeof b.outputHeaders["content-type"]?b.outputConverter(h[b.outputType](s)):b._undefined,b.status,b.outputHeaders)}catch(d){b.cb(d)}b.cb=null}}},x=!1;if("undefined"!=typeof s.onload&&(x=!0,s.onload=function(){u.success=!0,w()}),"undefined"!=typeof s.onreadystatechange&&(s.onreadystatechange=function(){if(2===s.readyState)v(!1);else if(3===s.readyState){if(u.success=!0,v(!1),null!==b.statusCb)return;try{b.updateDownload(i[b.outputType](s))}catch(a){}}else 4!==s.readyState||x||w()}),!r||q.corsRequestHeaders)for(var y in b.inputHeaders)b.inputHeaders.hasOwnProperty(y)&&s.setRequestHeader(y,b.inputHeaders[y]);return setTimeout(function(){if(null!==b.cb){if("undefined"==typeof s.response)try{"bytearray"===b.outputType?s.overrideMimeType("text/plain; charset=x-user-defined"):"text"===b.outputType&&"text/"!==b.outputHeaders["content-type"].substr(0,"text/".length)&&s.overrideMimeType("text/plain")}catch(c){}else try{s.responseType="bytearray"===b.outputType?"arraybuffer":"text"}catch(c){}if("bytearray"===b.inputType){var d=!1,e=!1,g=!1,h=window.BlobBuilder||window.WebKitBlobBuilder||window.MozBlobBuilder||window.MSBlobBuilder;"[object Array]"===Object.prototype.toString.call(b.input)&&(b.input="undefined"==typeof Uint8Array?l(b.input):new Uint8Array(b.input));var i=function(){var c,j;if(e&&d&&g)return a.failWithoutRequest(b.cb,new Error("Unable to send"));if(a.isArrayBufferView(b.input))if(d)if(g){if(!e)if("undefined"==typeof h)try{b.input=new Blob([b.input],{type:b.inputHeaders["Content-Type"]})}catch(k){e=!0}else j=new h,j.append(b.input),b.input=j.getBlob(b.inputHeaders["Content-Type"])}else try{b.input=l(new Uint8Array(b.input))}catch(k){g=!0}else try{return b.inputLength=b.input.byteLength,"undefined"==typeof window.ArrayBufferView?s.send(f(b.input.buffer,b.input.byteOffset,b.input.byteOffset+b.input.byteLength)):s.send(b.input),void 0}catch(k){d=!0}else if("undefined"!=typeof Blob&&b.input instanceof Blob)if(e)if(d){if(!g)try{return c=new FileReader,c.onerror=function(){g=!0,i()},c.onload=function(){b.input=c.result,i()},c.readAsBinaryString(b.input),void 0}catch(k){g=!0}}else try{return c=new FileReader,c.onerror=function(){d=!0,i()},c.onload=function(){b.input=new Uint8Array(c.result),i()},c.readAsArrayBuffer(b.input),void 0}catch(k){d=!0}else try{return b.inputLength=b.input.size,s.send(b.input),void 0}catch(k){e=!0}else if(g)if(d){if(!e)if("undefined"==typeof h)try{b.input=new Blob([b.input],{type:b.inputHeaders["Content-Type"]})}catch(k){e=!0}else j=new h,j.append(b.input),b.input=j.getBlob(b.inputHeaders["Content-Type"])}else try{for(var m=new ArrayBuffer(b.input.length),n=new Uint8Array(m),o=0;o<b.input.length;o+=1)n[o]=255&b.input[o];b.input=n}catch(k){d=!0}else try{return b.inputLength=b.input.length,s.sendAsBinary(b.input),void 0}catch(k){g=!0}setTimeout(i,0)};i()}else"text"===b.inputType?(b.inputLength=k(b.input),s.send(b.input)):s.send(null);m(0)}},0),function(){if(null!==b.cb){var a=b.cb;b.cb=null,a(new Error("abort"));try{s.abort()}catch(c){}}}};return q.corsResponseContentTypeOnly=!1,q.corsRequestHeaders=!1,q.corsCredentials=!1,q.cors=!1,q.corsDELETE=!1,q.corsHEAD=!1,q.corsPUT=!1,q.corsStatus=!1,q.corsResponseTextOnly=!1,q.requestTextOnly=!1,function(){try{g=function(){return new window.XMLHttpRequest};var a=g();if(q.requestTextOnly="undefined"==typeof Uint8Array&&"undefined"==typeof a.sendAsBinary,q.cors="withCredentials"in a,!q.cors)throw"";return q.corsRequestHeaders=!0,q.corsCredentials=!0,q.corsDELETE=!0,q.corsPUT=!0,q.corsHEAD=!0,q.corsStatus=!0,void 0}catch(b){}try{return"undefined"==typeof XDomainRequest?(g=function(){return new window.XMLHttpRequest},g()):(g=function(a){return a?new window.XDomainRequest:new window.XMLHttpRequest},g(!0),q.cors=!0,q.corsResponseContentTypeOnly=!0,q.corsResponseTextOnly=!0),void 0}catch(b){}try{return g(),void 0}catch(b){}for(var c=["Microsoft.XMLHTTP","Msxml2.XMLHTTP.6.0","Msxml2.XMLHTTP.3.0","Msxml2.XMLHTTP"],d=c.length-1;d>=0;){try{return g=function(){return new window.ActiveXObject(c[d])},g(),void 0}catch(b){}d-=1}g=function(){throw new Error("Cannot construct XMLHttpRequest")}}(),q});