/*! httpinvoke 2013-10-04 */
!function(a,b){"function"==typeof define&&define.amd?define(b):"object"==typeof exports?module.exports=b():a.httpinvoke=b()}(this,function(){var a;a=window;var b,c,d,e=function(b){return"object"==typeof b&&null!==b&&(a.ArrayBufferView&&b instanceof ArrayBufferView||a.Int8Array&&b instanceof Int8Array||a.Uint8Array&&b instanceof Uint8Array||a.Uint8ClampedArray&&b instanceof Uint8ClampedArray||a.Int16Array&&b instanceof Int16Array||a.Uint16Array&&b instanceof Uint16Array||a.Int32Array&&b instanceof Int32Array||a.Uint32Array&&b instanceof Uint32Array||a.Float32Array&&b instanceof Float32Array||a.Float64Array&&b instanceof Float64Array)},f=function(a){return"[object Array]"===Object.prototype.toString.call(a)},g=function(b){return"object"==typeof b&&null!==b&&(a.Buffer&&b instanceof Buffer||a.Blob&&b instanceof Blob||a.File&&b instanceof File||a.ArrayBuffer&&b instanceof ArrayBuffer||e(b)||f(b))},h="an instance of Buffer, nor Blob, nor File, nor ArrayBuffer, nor ArrayBufferView, nor Int8Array, nor Uint8Array, nor Uint8ClampedArray, nor Int16Array, nor Uint16Array, nor Int32Array, nor Uint32Array, nor Float32Array, nor Float64Array, nor Array",i=["GET","HEAD","POST","PUT","DELETE"],j=[].indexOf?function(a,b){return a.indexOf(b)}:function(a,b){for(var c=-1;++c<a.length;)if(a[c]===b)return c;return-1},k=function(a){return a},l=a.process&&a.process.nextTick||a.setImmediate||a.setTimeout,m=function(){for(var a=arguments.length,b={};a--;)for(var c=arguments[a].split(","),d=c.length;d--;)b[c[d]]=100*(a+1)+d;return b}("Continue,Switching Protocols","OK,Created,Accepted,Non-Authoritative Information,No Content,Reset Content,Partial Content","Multiple Choices,Moved Permanently,Found,See Other,Not Modified,Use Proxy,_,Temporary Redirect","Bad Request,Unauthorized,Payment Required,Forbidden,Not Found,Method Not Allowed,Not Acceptable,Proxy Authentication Required,Request Timeout,Conflict,Gone,Length Required,Precondition Failed,Request Entity Too Large,Request-URI Too Long,Unsupported Media Type,Requested Range Not Satisfiable,Expectation Failed","Internal Server Error,Not Implemented,Bad Gateway,Service Unavailable,Gateway Time-out,HTTP Version Not Supported"),n=function(a,b,c){return 0===b&&c===a.byteLength?a:a.slice?a.slice(b,c):new Uint8Array(Array.prototype.slice.call(new Uint8Array(a),b,c)).buffer};!function(){try{execScript("Function httpinvoke0(B,A)\r\nDim i\r\nFor i=1 to LenB(B)\r\nA.push(AscB(MidB(B,i,1)))\r\nNext\r\nEnd Function\r\nFunction httpinvoke1(B)\r\nhttpinvoke1=LenB(B)\r\nEnd Function","vbscript"),c=function(a){var b=[];return httpinvoke0(a,b),b},d=function(a){return httpinvoke1(a)}}catch(a){}}();var o,p=function(a){return a.response||a.responseText},q=function(a){for(var b=a.length,c=new Array(b);b--;)c[b]=255&a.charCodeAt(b);return c},r=function(b){if("response"in b)return new Uint8Array(b.response||[]);if("responseBody"in b)return c(b.responseBody);var d=q(b.responseText);return a.Uint8Array?new a.Uint8Array(d):d},s=function(a){return u(p(a))},t=function(a){return"response"in a?a.response?a.response.byteLength:0:"responseBody"in a?d(a.responseBody):a.responseText.length},u=function(a){for(var b,c=0,d=a.length;d--;)b=a.charCodeAt(d),c+=128>b?1:2048>b?2:3;return c},v=function(a,b,c){var d,e,f;for(b=a.getAllResponseHeaders().split(/\r?\n/),d=b.length;d--&&(e=b[d].indexOf(":"))>=0;)c[b[d].slice(0,e).toLowerCase()]=f.slice(e+2);return d+1!==b.length},w=/^([\w.+-]+:)(?:\/\/([^\/?#:]*)(?::(\d+)|)|)/,x=function(a,b){return b=w.exec(b.toLowerCase()),a=w.exec(a.toLowerCase())||[],!(!b||b[1]===a[1]&&b[2]===a[2]&&(b[3]||("http:"===b[1]?"80":"443"))===(a[3]||("http:"===a[1]?"80":"443")))},y=function(c,d,w,z){var A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S;d?w?z?w.finished=z:"object"==typeof d?(d.finished=w,w=d,d="GET"):"function"==typeof w&&(w={finished:w}):"string"==typeof d?w={}:"object"==typeof d?(w=d,d="GET"):(w={finished:d},d="GET"):(d="GET",w={});var T=function(a,b){return a in w?function(c,d,e,f){try{w[a](c,d,e,f)}catch(g){}b(c,d,e,f)}:b};A=function(a){var b=[],c=function(a,b){a&&a.then&&a.then(b.resolve.bind(b),b.reject.bind(b),b.notify.bind(b))},d=function(a){if(f(b)){var d,e=function(){b=a};a instanceof Error?d="onreject":a.type?(d="onnotify",e=k):d="onresolve";for(var g,h=0;h<b.length;h++)try{g=b[h][d](a),e!==k&&c(g,b[h].promise)}catch(i){}e()}};return a.then=function(a,d,e){var g=A({});return f(b)?b.push({onresolve:a,onreject:d,onnotify:e,promise:g}):b instanceof Error?l(function(){c(d(b),g)}):l(function(){c(a(b),g)}),g},a.notify=d,a.resolve=d,a.reject=d,a},C=function(a,b){return l(function(){null!==a&&a(b)}),B=function(){},A(B)},D=T("uploading",function(a,b){B.notify({type:"upload",current:a,total:b})});var U=T("downloading",function(a,b){B.notify({type:"download",current:a,total:b})});J=T("gotStatus",function(a,b){B.notify({type:"headers",statusCode:a,headers:b})}),z=T("finished",function(a,b,c,d){return a?B.reject(a):(B.resolve({body:b,statusCode:c,headers:d}),void 0)}),G=w.timeout||0;var V,W=w.converters||{};if(E=0,H=w.headers||{},M={},N=w.corsExposedHeaders||[],N.push.apply(N,["Cache-Control","Content-Language","Content-Type","Content-Length","Expires","Last-Modified","Pragma","Content-Range"]),I=w.corsOriginHeader||"X-Httpinvoke-Origin",j(i,d)<0)return C(z,new Error("Unsupported method "+d));if(P="bytearray"===w.outputType,!w.outputType||"text"===w.outputType||P)S=k;else if(W["text "+w.outputType])S=W["text "+w.outputType],P=!1;else{if(!W["bytearray "+w.outputType])return C(z,new Error("Unsupported outputType "+w.outputType));S=W["bytearray "+w.outputType],P=!0}if(V=k,"input"in w){if(Q=w.input,w.inputType&&"auto"!==w.inputType)if("text"===w.inputType){if("string"!=typeof Q)return C(z,new Error("inputType is text, but input is not a string"))}else if("bytearray"===w.inputType){if(!g(Q))return C(z,new Error("inputType is bytearray, but input is neither "+h))}else if(W[w.inputType+" text"])V=W[w.inputType+" text"];else{if(!W[w.inputType+" bytearray"])return C(z,new Error("There is no converter for specified inputType"));V=W[w.inputType+" bytearray"]}else if("string"!=typeof Q&&!g(Q))return C(z,new Error("inputType is undefined or auto and input is neither string, nor "+h));"string"==typeof Q?H["Content-Type"]||(H["Content-Type"]="text/plain; charset=UTF-8"):(H["Content-Type"]||(H["Content-Type"]="application/octet-stream"),a.ArrayBuffer&&Q instanceof ArrayBuffer?Q=new Uint8Array(Q):e(Q)&&(Q=new Uint8Array(Q.buffer,Q.byteOffset,Q.byteLength)));try{Q=V(Q)}catch(X){return C(z,X)}}else{if(w.inputType)return C(z,new Error('"input" is undefined, but inputType is defined'));if(H["Content-Type"])return C(z,new Error('"input" is undefined, but Content-Type request header is defined'))}var Y;K=function(a){"undefined"==typeof R&&U(Y,R=a)},L=function(a){a!==Y&&U(Y=a,R)},F=function(){K(0),z&&(z(null,b,O,M),z=null)};var Z,$=P?r:p,_=P?t:s,ab=!1,bb=function(a){D&&(ab||(ab=!0,D(0,E),z))&&(D(a,E),a===E&&(D=null))};try{Z=a.location.href}catch(cb){Z=a.document.createElement("a"),Z.href="",Z=Z.href}var db=x(Z,c);if("object"==typeof Q&&y.requestTextOnly)return C(z,new Error("bytearray inputType is not supported on this platform, please always test using requestTextOnly feature flag"));if(db&&!y.cors)return C(z,new Error("Cross-origin requests are not supported"));if(db&&"DELETE"===d&&!y.corsDELETE)return C(z,new Error("DELETE method in cross-origin requests is not supported in this browser"));if(db&&"PUT"===d&&!y.corsPUT)return C(z,new Error("PUT method in cross-origin requests is not supported in this browser"));if(db&&"HEAD"===d&&!y.corsHEAD)return C(z,new Error("HEAD method in cross-origin requests is not supported in this browser"));if(!o)return C(z,new Error("unable to construct XMLHttpRequest object"));var eb=o(db);eb.open(d,c,!0),G>0&&("timeout"in eb?eb.timeout=G:setTimeout(function(){z(new Error("download timeout")),z=null},G)),w.corsCredentials&&y.corsCredentials&&"boolean"==typeof eb.withCredentials&&(eb.withCredentials=!0),db&&(H[I]=a.location.protocol+"//"+a.location.host);var fb=function(a){return function(){z&&(z(new Error(a)),z=null)}},gb=function(a){z&&a.lengthComputable&&bb(a.loaded)};"upload"in eb?(eb.upload.ontimeout=fb("upload timeout"),eb.upload.onerror=fb("upload error"),eb.upload.onprogress=gb):"onuploadprogress"in eb&&(eb.onuploadprogress=gb),"ontimeout"in eb&&(eb.ontimeout=fb("download timeout")),"onerror"in eb&&(eb.onerror=function(){jb()}),"onloadstart"in eb&&(eb.onloadstart=function(){ib(!1)}),"onloadend"in eb&&(eb.onloadend=function(){ib(!1)}),"onprogress"in eb&&(eb.onprogress=function(a){if(z&&(ib(!1),!J)){var b=a.total||a.totalSize||0,c=a.loaded||a.position||0;a.lengthComputable&&K(b),z&&(c>b||L(c))}});var hb={success:!1,status:!1,entity:!1,headers:!1},ib=function(a){if(z){try{eb.status&&(hb.status=!0)}catch(b){}try{eb.statusText&&(hb.status=!0)}catch(b){}try{eb.responseText&&(hb.entity=!0)}catch(b){}try{eb.response&&(hb.entity=!0)}catch(b){}if(J){if(hb.status||hb.entity||hb.success||a){"string"==typeof eb.contentType&&("text/html"!==eb.contentType||""!==eb.responseText)&&(M["content-type"]=eb.contentType,hb.headers=!0);for(var c=0;c<N.length;c+=1){var e;try{(e=eb.getResponseHeader(N[c]))&&(M[N[c].toLowerCase()]=e,hb.headers=!0)}catch(f){}}try{v(eb,M)&&(hb.headers=!0)}catch(f){}if(!O&&(!db||y.corsStatus)){try{eb.status&&(O=eb.status)}catch(b){}if(!O)try{O=m[eb.statusText]}catch(b){}1223===O&&(O=204)}}if((a||hb.status&&hb.headers)&&(bb(E),z&&(J(O,M),J=null,z))){if("HEAD"===d)return F();L(0),z&&"content-length"in M&&(K(Number(M["content-length"])),!z)}}}},jb=function(){if(z&&(ib(!0),z)){if(!hb.success&&!O)return z(new Error("download error")),z=null,void 0;var a;try{a=_(eb)}catch(c){return F()}if(R?a!==R&&(z(new Error("download error")),z=null):K(a),z&&(L(R),z)){try{z(null,hb.entity||0!==R||"undefined"!=typeof M["content-type"]?S($(eb)):b,O,M)}catch(d){z(d)}z=null}}},kb=!1;if("undefined"!=typeof eb.onload&&(kb=!0,eb.onload=function(){hb.success=!0,jb()}),"undefined"!=typeof eb.onreadystatechange&&(eb.onreadystatechange=function(){if(2===eb.readyState)ib(!1);else if(3===eb.readyState){if(hb.success=!0,ib(!1),J)return;try{L(_(eb))}catch(a){}}else 4!==eb.readyState||kb||jb()}),!db||y.corsRequestHeaders)for(var lb in H)if(H.hasOwnProperty(lb))try{eb.setRequestHeader(lb,H[lb])}catch(X){return C(z,X)}return l(function(){if(z){if("response"in eb)try{eb.responseType=P?"arraybuffer":"text"}catch(b){}else try{P&&eb.overrideMimeType("text/plain; charset=x-user-defined")}catch(b){}if("object"==typeof Q){var c=!1,d=!1,g=!1,h=a.BlobBuilder||a.WebKitBlobBuilder||a.MozBlobBuilder||a.MSBlobBuilder;f(Q)&&(Q=a.Uint8Array?new Uint8Array(Q):String.fromCharCode.apply(String,Q));var i=h?function(){var a=new h;a.append(Q),Q=a.getBlob(H["Content-Type"])}:function(){try{Q=new Blob([Q],{type:H["Content-Type"]})}catch(a){d=!0}},j=function(){var b;if(d&&c&&g)return C(z,new Error("Unable to send"));if(e(Q))if(c)if(g)d||i();else try{Q=String.fromCharCode.apply(String,Q)}catch(f){g=!0}else try{return E=Q.byteLength,eb.send(a.ArrayBufferView?Q:n(Q.buffer,Q.byteOffset,Q.byteOffset+Q.byteLength)),void 0}catch(f){c=!0}else if(a.Blob&&Q instanceof Blob)if(d)if(c){if(!g)try{return b=new FileReader,b.onerror=function(){g=!0,j()},b.onload=function(){Q=b.result,j()},b.readAsBinaryString(Q),void 0}catch(f){g=!0}}else try{return b=new FileReader,b.onerror=function(){c=!0,j()},b.onload=function(){try{Q=new Uint8Array(b.result)}catch(a){c=!0}j()},b.readAsArrayBuffer(Q),void 0}catch(f){c=!0}else try{return E=Q.size,eb.send(Q),void 0}catch(f){d=!0}else if(g)if(c)d||i();else try{Q=q(Q)}catch(f){c=!0}else try{return E=Q.length,eb.sendAsBinary(Q),void 0}catch(f){g=!0}l(j)};j()}else try{"string"==typeof Q?(E=u(Q),eb.send(Q)):eb.send(null)}catch(b){return z=null,C(z,new Error("Unable to send"))}bb(0)}}),B=function(){if(z){var a=z;z=null,a(new Error("abort"));try{eb.abort()}catch(b){}}},A(B)};return y.corsResponseContentTypeOnly=!1,y.corsRequestHeaders=!1,y.corsCredentials=!1,y.cors=!1,y.corsDELETE=!1,y.corsHEAD=!1,y.corsPUT=!1,y.corsStatus=!1,y.corsResponseTextOnly=!1,y.requestTextOnly=!1,function(){try{o=function(){return new a.XMLHttpRequest};var c=o();if(y.requestTextOnly="undefined"==typeof Uint8Array&&"undefined"==typeof c.sendAsBinary,y.cors="withCredentials"in c,y.cors)return y.corsRequestHeaders=!0,y.corsCredentials=!0,y.corsDELETE=!0,y.corsPUT=!0,y.corsHEAD=!0,y.corsStatus=!0,void 0}catch(d){}try{return"undefined"==typeof XDomainRequest?(o=function(){return new a.XMLHttpRequest},o()):(o=function(b){return b?new a.XDomainRequest:new a.XMLHttpRequest},o(!0),y.cors=!0,y.corsResponseContentTypeOnly=!0,y.corsResponseTextOnly=!0),void 0}catch(d){}try{return o(),void 0}catch(d){}for(var e=["Microsoft.XMLHTTP","Msxml2.XMLHTTP.6.0","Msxml2.XMLHTTP.3.0","Msxml2.XMLHTTP"],f=e.length-1;f>=0;){try{return o=function(){return new a.ActiveXObject(e[f])},o(),void 0}catch(d){}f-=1}o=b}(),y});