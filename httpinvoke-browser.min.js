/*! httpinvoke 2013-10-03 */
!function(a,b){"function"==typeof define&&define.amd?define(b):"object"==typeof exports?module.exports=b():a.httpinvoke=b()}(this,function(){var a;a=window;var b,c,d=function(b){return"object"==typeof b&&null!==b&&("undefined"!=typeof a.ArrayBufferView&&b instanceof a.ArrayBufferView||"undefined"!=typeof a.Int8Array&&b instanceof a.Int8Array||"undefined"!=typeof a.Uint8Array&&b instanceof a.Uint8Array||"undefined"!=typeof a.Uint8ClampedArray&&b instanceof a.Uint8ClampedArray||"undefined"!=typeof a.Int16Array&&b instanceof a.Int16Array||"undefined"!=typeof a.Uint16Array&&b instanceof a.Uint16Array||"undefined"!=typeof a.Int32Array&&b instanceof a.Int32Array||"undefined"!=typeof a.Uint32Array&&b instanceof a.Uint32Array||"undefined"!=typeof a.Float32Array&&b instanceof a.Float32Array||"undefined"!=typeof a.Float64Array&&b instanceof a.Float64Array)},e=function(b){return"object"==typeof b&&null!==b&&("undefined"!=typeof a.Buffer&&b instanceof a.Buffer||"undefined"!=typeof a.Blob&&b instanceof a.Blob||"undefined"!=typeof a.File&&b instanceof a.File||"undefined"!=typeof a.ArrayBuffer&&b instanceof a.ArrayBuffer||d(b)||"[object Array]"===Object.prototype.toString.call(b))},f="an instance of Buffer, nor Blob, nor File, nor ArrayBuffer, nor ArrayBufferView, nor Int8Array, nor Uint8Array, nor Uint8ClampedArray, nor Int16Array, nor Uint16Array, nor Int32Array, nor Uint32Array, nor Float32Array, nor Float64Array, nor Array",g=["GET","HEAD","POST","PUT","DELETE"],h="undefined"==typeof[].indexOf?function(a,b){for(var c=0;c<a.length;c+=1)if(a[c]===b)return c;return-1}:function(a,b){return a.indexOf(b)},i=["accept-charset","accept-encoding","access-control-request-headers","access-control-request-method","connection","content-length","content-transfer-encoding","cookie","cookie2","date","dnt","expect","host","keep-alive","origin","referer","te","trailer","transfer-encoding","upgrade","user-agent","via"],j=function(a){for(var b in a)if(a.hasOwnProperty(b)){var c=b.toLowerCase();if(h(i,c)>=0)throw new Error("Input header "+b+" is forbidden to be set programmatically");if("proxy-"===c.substr(0,"proxy-".length))throw new Error("Input header "+b+" (to be precise, all Proxy-*) is forbidden to be set programmatically");if("sec-"===c.substr(0,"sec-".length))throw new Error("Input header "+b+" (to be precise, all Sec-*) is forbidden to be set programmatically")}},k=function(){},l=function(a){return a},m=a.setImmediate||a.setTimeout,n=function(a,b){return m(function(){null!==a&&a(b)}),k},o=function(a){return"string"==typeof a&&""!==a},p={Continue:100,"Switching Protocols":101,OK:200,Created:201,Accepted:202,"Non-Authoritative Information":203,"No Content":204,"Reset Content":205,"Partial Content":206,"Multiple Choices":300,"Moved Permanently":301,Found:302,"See Other":303,"Not Modified":304,"Use Proxy":305,"Temporary Redirect":307,"Bad Request":400,Unauthorized:401,"Payment Required":402,Forbidden:403,"Not Found":404,"Method Not Allowed":405,"Not Acceptable":406,"Proxy Authentication Required":407,"Request Timeout":408,Conflict:409,Gone:410,"Length Required":411,"Precondition Failed":412,"Request Entity Too Large":413,"Request-URI Too Long":414,"Unsupported Media Type":415,"Requested Range Not Satisfiable":416,"Expectation Failed":417,"Internal Server Error":500,"Not Implemented":501,"Bad Gateway":502,"Service Unavailable":503,"Gateway Time-out":504,"HTTP Version Not Supported":505},q=function(a,b,c){return 0===b&&c===a.byteLength?a:"undefined"==typeof a.slice?new Uint8Array(Array.prototype.slice.call(new Uint8Array(a),b,c)).buffer:a.slice(b,c)};!function(){try{var d="";d+="Function httpinvoke_BinaryExtract(Binary, Array)\r\n",d+="    Dim len, i\r\n",d+="    len = LenB(Binary)\r\n",d+="    For i = 1 to len\r\n",d+="        Array.push(AscB(MidB(Binary, i, 1)))\r\n",d+="    Next\r\n",d+="End Function\r\n",d+="\r\n",d+="Function httpinvoke_BinaryLength(Binary)\r\n",d+="    httpinvoke_BinaryLength = LenB(Binary)\r\n",d+="End Function\r\n",d+="\r\n",a.execScript(d,"vbscript");for(var e={},f=0;256>f;f+=1)for(var g=0;256>g;g+=1)e[String.fromCharCode(f+256*g)]=String.fromCharCode(f)+String.fromCharCode(g);b=function(b){var c=[];return a.httpinvoke_BinaryExtract(b,c),c},c=function(b){return a.httpinvoke_BinaryLength(b)}}catch(h){}}();var r,s={text:function(a){return"undefined"!=typeof a.response?a.response:a.responseText},bytearray:function(a){if("undefined"!=typeof a.response)return new Uint8Array(null===a.response?[]:a.response);if("undefined"!=typeof a.responseBody)return b(a.responseBody);for(var c=a.responseText,d=c.length,e=new Array(d),f=0;d>f;f+=1)e[f]=255&c.charCodeAt(f);return"undefined"!=typeof Uint8Array?new Uint8Array(e):e}},t={text:function(a){return v(s.text(a))},bytearray:function(a){return"undefined"!=typeof a.response?null===a.response?0:a.response.byteLength:"undefined"!=typeof a.responseBody?c(a.responseBody):a.responseText.length}},u="undefined"==typeof"".trim?function(a){return a.replace(/^\s+|\s+$/g,"")}:function(a){return a.trim()},v=function(a){for(var b=0,c=0;c<a.length;c+=1){var d=a.charCodeAt(c);b+=128>d?1:2048>d?2:3}return b},w=function(a){for(var b="",c=0;c<a.length;c+=1)b+=String.fromCharCode(a[c]);return b},x=function(a){var b=a.indexOf(":");return{name:a.slice(0,b).toLowerCase(),value:u(a.slice(b+1))}},y=function(a,b,c){b=a.getAllResponseHeaders().split(/\r?\n/);for(var d,e=b.length-1,f=!1;e>=0;)d=u(b[e]),d.length>0&&(d=x(d),c[d.name]=d.value,f=!0),e-=1;return f},z=/^([\w.+-]+:)(?:\/\/([^\/?#:]*)(?::(\d+)|)|)/,A=function(a,b){return b=z.exec(b.toLowerCase()),a=z.exec(a.toLowerCase())||[],!(!b||b[1]===a[1]&&b[2]===a[2]&&(b[3]||("http:"===b[1]?"80":"443"))===(a[3]||("http:"===a[1]?"80":"443")))},B=function(b,c,i){var m,u,x,z,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R;"undefined"==typeof c?(c="GET",i={}):"undefined"==typeof i&&("string"==typeof c?i={}:(i=c,c="GET")),i="function"==typeof i?{finished:i}:i;var S=function(a){return"undefined"==typeof i[a]?k:function(){try{i[a].apply(null,arguments)}catch(b){}}};m=S("uploading");var T=S("downloading");H=S("gotStatus"),u=S("finished"),D=i.timeout||0;var U,V=i.converters||{};if(x=0,F=i.headers||{},N=i.outputType||"text",K={},L=i.corsExposedHeaders||[],L.push.apply(L,["Cache-Control","Content-Language","Content-Type","Content-Length","Expires","Last-Modified","Pragma","Content-Range"]),G=i.corsOriginHeader||"X-Httpinvoke-Origin",E=!!i.corsCredentials,h(g,c)<0)return n(u,new Error("Unsupported method "+c));if("text"===N||"bytearray"===N)Q=l;else if("undefined"!=typeof V["text "+N])Q=V["text "+N],N="text";else{if("undefined"==typeof V["bytearray "+N])return n(u,new Error("Unsupported outputType "+N));Q=V["bytearray "+N],N="bytearray"}if("undefined"==typeof i.input){if("undefined"!=typeof i.inputType)return n(u,new Error('"input" is undefined, but inputType is defined'));if("undefined"!=typeof F["Content-Type"])return n(u,new Error('"input" is undefined, but Content-Type request header is defined'))}else{if(O=i.input,"undefined"==typeof i.inputType||"auto"===i.inputType)if("string"==typeof O)z="text";else{if(!e(O))return n(u,new Error("inputType is undefined or auto and input is neither string, nor "+f));z="bytearray"}else if(z=i.inputType,"text"===z){if("string"!=typeof O)return n(u,new Error("inputType is text, but input is not a string"))}else if("bytearray"===z&&!e(O))return n(u,new Error("inputType is bytearray, but input is neither "+f));if("undefined"!=typeof V[z+" text"])U=V[z+" text"],z="text";else if("undefined"!=typeof V[z+" bytearray"])U=V[z+" bytearray"],z="bytearray";else{if("text"!==z&&"bytearray"!==z)return n(u,new Error("There is no converter for specified inputType"));U=l}"text"===z?"undefined"==typeof F["Content-Type"]&&(F["Content-Type"]="text/plain; charset=UTF-8"):"bytearray"===z&&("undefined"==typeof F["Content-Type"]&&(F["Content-Type"]="application/octet-stream"),"undefined"!=typeof ArrayBuffer&&O instanceof ArrayBuffer?O=new Uint8Array(O):("undefined"!=typeof Int16Array&&O instanceof Int16Array||"undefined"!=typeof Uint16Array&&O instanceof Uint16Array||"undefined"!=typeof Int32Array&&O instanceof Int32Array||"undefined"!=typeof Uint32Array&&O instanceof Uint32Array||"undefined"!=typeof Float32Array&&O instanceof Float32Array||"undefined"!=typeof Float64Array&&O instanceof Float64Array)&&(O=new Uint8Array(O.buffer,O.byteOffset,O.byteLength)));try{O=U(O)}catch(W){return n(u,W)}}try{j(F)}catch(W){return n(u,W)}var X;I=function(a){"undefined"==typeof P&&(P=a,T(X,P))},J=function(a){a!==X&&(X=a,T(X,P))},C=function(){I(0),null!==u&&(u(null,R,M,K),u=null)};var Y,Z=!1,$=function(a){null!==m&&(Z||(Z=!0,m(0,x)),m(a,x),a===x&&(m=null))};try{Y=a.location.href}catch(_){Y=a.document.createElement("a"),Y.href="",Y=Y.href}var ab=A(Y,b);if("bytearray"===z&&B.requestTextOnly)return n(u,new Error("bytearray inputType is not supported on this platform, please always test using requestTextOnly feature flag"));if(ab&&!B.cors)return n(u,new Error("Cross-origin requests are not supported"));if(ab&&"DELETE"===c&&!B.corsDELETE)return n(u,new Error("DELETE method in cross-origin requests is not supported in this browser"));if(ab&&"PUT"===c&&!B.corsPUT)return n(u,new Error("PUT method in cross-origin requests is not supported in this browser"));if(ab&&"HEAD"===c&&!B.corsHEAD)return n(u,new Error("HEAD method in cross-origin requests is not supported in this browser"));var bb=r(ab);bb.open(c,b,!0),D>0&&("undefined"==typeof bb.timeout?setTimeout(function(){u(new Error("download timeout")),u=null},D):bb.timeout=D),E&&B.corsCredentials&&"boolean"==typeof bb.withCredentials&&(bb.withCredentials=!0),ab&&(F[G]=a.location.protocol+"//"+a.location.host);var cb=function(a){null!==u&&a&&a.lengthComputable&&$(a.loaded)};"undefined"!=typeof bb.upload?(bb.upload.ontimeout=function(){null!==u&&(u(new Error("upload timeout")),u=null)},bb.upload.onerror=function(){null!==u&&(u(new Error("upload error")),u=null)},bb.upload.onprogress=cb):"undefined"!=typeof bb.onuploadprogress&&(bb.onuploadprogress=cb),"undefined"!=typeof bb.ontimeout&&(bb.ontimeout=function(){null!==u&&(u(new Error("download timeout")),u=null)}),"undefined"!=typeof bb.onerror&&(bb.onerror=function(){fb()}),"undefined"!=typeof bb.onloadstart&&(bb.onloadstart=function(){eb(!1)}),"undefined"!=typeof bb.onloadend&&(bb.onloadend=function(){eb(!1)}),"undefined"!=typeof bb.onprogress&&(bb.onprogress=function(a){if(null!==u&&(eb(!1),null===H&&"undefined"!=typeof a)){var b=a.total||a.totalSize||0,c=a.loaded||a.position||0;if(a.lengthComputable&&I(b),null===u)return;if(c>b)return;J(c)}});var db={success:!1,status:!1,entity:!1,headers:!1},eb=function(a){if(null!==u){try{"number"==typeof bb.status&&bb.status>0&&(db.status=!0)}catch(b){}try{o(bb.statusText)&&(db.status=!0)}catch(b){}try{o(bb.responseText)&&(db.entity=!0)}catch(b){}try{(o(bb.response)||"object"==typeof bb.response&&null!==bb.response)&&(db.entity=!0)}catch(b){}if(null!==H){if(db.status||db.entity||db.success||a){"string"==typeof bb.contentType&&("text/html"!==bb.contentType||""!==bb.responseText)&&(K["content-type"]=bb.contentType,db.headers=!0);for(var d=0;d<L.length;d+=1)try{var e=bb.getResponseHeader(L[d]);null!==e&&""!==e&&(K[L[d].toLowerCase()]=e,db.headers=!0)}catch(f){}try{y(bb,K)&&(db.headers=!0)}catch(f){}if("undefined"==typeof M&&(!ab||B.corsStatus)){try{"number"==typeof bb.status&&bb.status>0&&(M=bb.status)}catch(b){}if("undefined"==typeof M)try{"undefined"!=typeof p[bb.statusText]&&(M=p[bb.statusText])}catch(b){}1223===M&&(M=204)}}if((a||db.status&&db.headers)&&($(x),null!==u&&(H(M,K),H=null,null!==u))){if("HEAD"===c)return C();J(0),null!==u&&"undefined"!=typeof K["content-length"]&&(I(Number(K["content-length"])),null===u)}}}},fb=function(){if(null!==u&&(eb(!0),null!==u)){if(!db.success&&"undefined"==typeof M)return u(new Error("download error")),u=null,void 0;var a;try{a=t[N](bb)}catch(b){return C()}if("undefined"==typeof P){if(I(a),null===u)return}else if(a!==P)return u(new Error("download error")),u=null,void 0;if(J(P),null!==u){try{u(null,db.entity||0!==P||"undefined"!=typeof K["content-type"]?Q(s[N](bb)):R,M,K)}catch(c){u(c)}u=null}}},gb=!1;if("undefined"!=typeof bb.onload&&(gb=!0,bb.onload=function(){db.success=!0,fb()}),"undefined"!=typeof bb.onreadystatechange&&(bb.onreadystatechange=function(){if(2===bb.readyState)eb(!1);else if(3===bb.readyState){if(db.success=!0,eb(!1),null!==H)return;try{J(t[N](bb))}catch(a){}}else 4!==bb.readyState||gb||fb()}),!ab||B.corsRequestHeaders)for(var hb in F)F.hasOwnProperty(hb)&&bb.setRequestHeader(hb,F[hb]);return setTimeout(function(){if(null!==u){if("undefined"==typeof bb.response)try{"bytearray"===N?bb.overrideMimeType("text/plain; charset=x-user-defined"):"text"===N&&"text/"!==K["content-type"].substr(0,"text/".length)&&bb.overrideMimeType("text/plain")}catch(b){}else try{bb.responseType="bytearray"===N?"arraybuffer":"text"}catch(b){}if("bytearray"===z){var c=!1,e=!1,f=!1,g=a.BlobBuilder||a.WebKitBlobBuilder||a.MozBlobBuilder||a.MSBlobBuilder;"[object Array]"===Object.prototype.toString.call(O)&&(O="undefined"==typeof Uint8Array?w(O):new Uint8Array(O));var h=function(){var b,i;if(e&&c&&f)return n(u,new Error("Unable to send"));if(d(O))if(c)if(f){if(!e)if("undefined"==typeof g)try{O=new a.Blob([O],{type:F["Content-Type"]})}catch(j){e=!0}else i=new g,i.append(O),O=i.getBlob(F["Content-Type"])}else try{O=w(new Uint8Array(O))}catch(j){f=!0}else try{return x=O.byteLength,"undefined"==typeof a.ArrayBufferView?bb.send(q(O.buffer,O.byteOffset,O.byteOffset+O.byteLength)):bb.send(O),void 0}catch(j){c=!0}else if("undefined"!=typeof a.Blob&&O instanceof a.Blob)if(e)if(c){if(!f)try{return b=new a.FileReader,b.onerror=function(){f=!0,h()},b.onload=function(){O=b.result,h()},b.readAsBinaryString(O),void 0}catch(j){f=!0}}else try{return b=new a.FileReader,b.onerror=function(){c=!0,h()},b.onload=function(){O=new Uint8Array(b.result),h()},b.readAsArrayBuffer(O),void 0}catch(j){c=!0}else try{return x=O.size,bb.send(O),void 0}catch(j){e=!0}else if(f)if(c){if(!e)if("undefined"==typeof g)try{O=new a.Blob([O],{type:F["Content-Type"]})}catch(j){e=!0}else i=new g,i.append(O),O=i.getBlob(F["Content-Type"])}else try{for(var k=new ArrayBuffer(O.length),l=new Uint8Array(k),m=0;m<O.length;m+=1)l[m]=255&O[m];O=l}catch(j){c=!0}else try{return x=O.length,bb.sendAsBinary(O),void 0}catch(j){f=!0}setTimeout(h,0)};h()}else"text"===z?(x=v(O),bb.send(O)):bb.send(null);$(0)}},0),function(){if(null!==u){var a=u;u=null,a(new Error("abort"));try{bb.abort()}catch(b){}}}};return B.corsResponseContentTypeOnly=!1,B.corsRequestHeaders=!1,B.corsCredentials=!1,B.cors=!1,B.corsDELETE=!1,B.corsHEAD=!1,B.corsPUT=!1,B.corsStatus=!1,B.corsResponseTextOnly=!1,B.requestTextOnly=!1,function(){try{r=function(){return new a.XMLHttpRequest};var b=r();if(B.requestTextOnly="undefined"==typeof Uint8Array&&"undefined"==typeof b.sendAsBinary,B.cors="withCredentials"in b,!B.cors)throw"";return B.corsRequestHeaders=!0,B.corsCredentials=!0,B.corsDELETE=!0,B.corsPUT=!0,B.corsHEAD=!0,B.corsStatus=!0,void 0}catch(c){}try{return"undefined"==typeof XDomainRequest?(r=function(){return new a.XMLHttpRequest},r()):(r=function(b){return b?new a.XDomainRequest:new a.XMLHttpRequest},r(!0),B.cors=!0,B.corsResponseContentTypeOnly=!0,B.corsResponseTextOnly=!0),void 0}catch(c){}try{return r(),void 0}catch(c){}for(var d=["Microsoft.XMLHTTP","Msxml2.XMLHTTP.6.0","Msxml2.XMLHTTP.3.0","Msxml2.XMLHTTP"],e=d.length-1;e>=0;){try{return r=function(){return new a.ActiveXObject(d[e])},r(),void 0}catch(c){}e-=1}r=function(){throw new Error("Cannot construct XMLHttpRequest")}}(),B});